function dsv(r){function n(n){return n.map(t).join(r)}function t(r){return o.test(r)?'"'+r.replace(/\"/g,'""')+'"':r}var e={},o=RegExp('["'+r+"\n]"),i=r.charCodeAt(0);return e.parse=function(r,n){var t;return e.parseRows(r,function(r,e){if(t)return t(r,e-1);var o=Function("d","return {"+r.map(function(r,n){return JSON.stringify(r)+": d["+n+"]"}).join(",")+"}");t=n?function(r,t){return n(o(r),t)}:o})},e.parseRows=function(r,n){function t(){if(s>=c)return a;if(o)return o=!1,u;var n=s;if(34===r.charCodeAt(n)){for(var t=n;c>t++;)if(34===r.charCodeAt(t)){if(34!==r.charCodeAt(t+1))break;++t}s=t+2;var e=r.charCodeAt(t+1);return 13===e?(o=!0,10===r.charCodeAt(t+2)&&++s):10===e&&(o=!0),r.slice(n+1,t).replace(/""/g,'"')}for(;c>s;){var e=r.charCodeAt(s++),f=1;if(10===e)o=!0;else if(13===e)o=!0,10===r.charCodeAt(s)&&(++s,++f);else if(e!==i)continue;return r.slice(n,s-f)}return r.slice(n)}for(var e,o,u={},a={},f=[],c=r.length,s=0,v=0;(e=t())!==a;){for(var d=[];e!==u&&e!==a;)d.push(e),e=t();n&&null==(d=n(d,v++))||f.push(d)}return f},e.format=function(n){if(Array.isArray(n[0]))return e.formatRows(n);var o={},i=[];return n.forEach(function(r){for(var n in r)n in o||i.push(o[n]=n)}),[i.map(t).join(r)].concat(n.map(function(n){return i.map(function(r){return t(n[r])}).join(r)})).join("\n")},e.formatRows=function(r){return r.map(n).join("\n")},e}dsv.version="0.0.4",dsv.tsv=dsv("	"),dsv.csv=dsv(",");